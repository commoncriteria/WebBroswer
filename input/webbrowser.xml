<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" href="..\transforms\pp2html.xsl"?>
<PP xmlns="http://common-criteria.rhcloud.com/ns/cc" name="Web Browsers">
    <PPReference title="PP Reference" id="ID003">
        <ReferenceTable>
            <PPTitle>Application Software Extended Package for Web Browsers</PPTitle>
            <PPVersion>Draft 1.9</PPVersion>
            <PPAuthor>National Information Assurance Partnership</PPAuthor>
            <PPPubDate>2015-02-19</PPPubDate>
            <PPCertificationID>unassigned</PPCertificationID>
            <CCVersion>Version 3.1</CCVersion>
            <Keywords>web browser; browser</Keywords>
            <entry>
                <name>Registration</name>
                <description>National Information Assurance Partnership</description>
            </entry>
        </ReferenceTable>
    </PPReference>
    <RevisionHistory role="draft">
        <entry>
            <version>v 1.0</version>
            <date>2014-03-31</date>
            <subject>Release - Protection Profile for Web Browsers</subject>
        </entry>
        <entry>
            <version>v 1.9</version>
            <date>2014-12-04</date>
            <subject>Interim Draft - Update as Extended Package of the Protection Profile for
                Application Software</subject>
        </entry>
    </RevisionHistory>
    <RevisionHistory role="release">
        <entry>
            <version>v 1.0</version>
            <date>2014-03-31</date>
            <subject>Initial release as Protection Profile for Web Browsers</subject>
        </entry>
        <entry>
            <version>v 2.0</version>
            <date>2014-12-12</date>
            <subject>Update as Extended Package of the Protection Profile for Application
                Software</subject>
        </entry>
    </RevisionHistory>
    <chapter title="Introduction" id="int">
        <section title="Overview" id="ppoverview">The scope of this Extended Package (EP) is to
            describe the security functionality of web browsers in terms of <cite linkend="bibCC"/>.
            This EP is not complete in itself, but rather extends the security requirements of the
            Protection Profile for Application Software (<cite linkend="bibAppPP"/>). </section>
        <section title="Terms" id="glossary">The following sections provide both Common Criteria and
            technology terms used in this Extended Package. <subsection
                title="Common Criteria Terms" id="ccterms">
                <glossary>
                    <entry>
                        <term><abbr title="Common Criteria">CC</abbr></term>
                        <description>Common Criteria for Information Technology Security
                            Evaluation.</description>
                    </entry>
                    <entry>
                        <term><abbr title="Extended Package">EP</abbr></term>
                        <description>An implementation-independent set of security requirements for
                            a category of products, which extends those in a Protection
                            Profile.</description>
                    </entry>
                    <entry>
                        <term><abbr title="Protection Profile">PP</abbr></term>
                        <description>An implementation-independent set of security requirements for
                            a category of products.</description>
                    </entry>
                    <entry>
                        <term><abbr title="Security Target">ST</abbr></term>
                        <description>A set of implementation-dependent security requirements for a
                            specific product.</description>
                    </entry>
                    <entry>
                        <term><abbr title="Target of Evaluation">TOE</abbr></term>
                        <description>The product under evaluation. In this case, application
                            software and its supporting documentation.</description>
                    </entry>
                    <entry>
                        <term><abbr title="TOE Security Functionality">TSF</abbr></term>
                        <description>The security functionality of the product under
                            evaluation.</description>
                    </entry>
                    <entry>
                        <term><abbr title="TOE Summary Specification">TSS</abbr></term>
                        <description>A description of how a <abbr linkend="TOE"/> satisfies the SFRs
                            in a <abbr linkend="ST"/>. </description>
                    </entry>
                    <entry>
                        <term><abbr title="Security Functional Requirement">SFR</abbr></term>
                        <description>A requirement for security enforcement by the <abbr
                                linkend="TOE"/>. </description>
                    </entry>
                    <entry>
                        <term><abbr title="Security Assurance Requirement">SAR</abbr></term>
                        <description>A requirement to assure the security of the <abbr linkend="TOE"
                            />. </description>
                    </entry>
                </glossary>
            </subsection>
            <subsection id="techterms" title="Technology Terms">
                <glossary>
                    <entry>
                        <term>Add-on</term>
                        <description>Capabilities or functionality added to an application. This
                            term includes plug-ins, extensions, and other controls.</description>
                    </entry>
                    <entry>
                        <term>Administrator</term>
                        <description>The Administrator is responsible for management activities,
                            including setting the policy that is applied by the enterprise on the
                            Browser. This administrator is likely to be acting remotely. If the
                            platform is unmanaged by an enterprise, the user can act as the
                            administrator.</description>
                    </entry>
                    <entry>
                        <term>CSRF</term>
                        <description>Cross Site Request Forgery - Vulnerability where an attacker
                            gets a target user to execute a script with that user's
                            privileges.</description>
                    </entry>
                    <entry>
                        <term>Extension</term>
                        <description>Bundle of code that are added to the browser to add specific
                            functionality that the browser does not provide by
                            default.</description>
                    </entry>
                    <entry>
                        <term>HTML</term>
                        <description>HyperText Markup Language - Language used by web servers to
                            present content to browsers.</description>
                    </entry>
                    <entry>
                        <term>HTML5</term>
                        <description>HyperText Markup Language version 5, a new version of HTML that
                            incorporates many new features that enrich the browsing
                            experience.</description>
                    </entry>
                    <entry>
                        <term>HTTP</term>
                        <description>HyperText Transfer Protocol - Protocol for communicating on the
                            web.</description>
                    </entry>
                    <entry>
                        <term>HTTPS</term>
                        <description>HyperText Transfer Protocol Secure; secure version of HTTP that
                            runs over an encrypted channel (SSL/TLS).</description>
                    </entry>
                    <entry>
                        <term>JavaScript</term>
                        <description>Scripting language commonly integrated into web pages to
                            generate dynamic, interactive content.</description>
                    </entry>
                    <entry>
                        <term>Mobile Code</term>
                        <description>As defined in the <cite linkend="bibAppPP"/>; however,
                            JavaScript is not included in references to mobile code in this browser
                            EP.</description>
                    </entry>
                    <entry>
                        <term>Plug-in</term>
                        <description>Browser add-on to handle specific types of web
                            content.</description>
                    </entry>
                    <entry>
                        <term>Pop-up</term>
                        <description>Piece of web code that causes a browser window to open outside
                            of the browser instance that is currently in focus.</description>
                    </entry>
                    <entry>
                        <term>Sandbox</term>
                        <description>Security mechanism for separating running processes, most often
                            used to run untrusted or vulnerable processes by reducing their
                            privileges to such an extent that they should not be able to harm the
                            host system.</description>
                    </entry>
                    <entry>
                        <term>Tabs</term>
                        <description>Allow the browsers to display content from multiple web sites
                            without starting another instance of the browser.</description>
                    </entry>
                    <entry>
                        <term>Web Browser</term>
                        <description>Application that retrieves and renders content provided by a
                            web server. The term web browser and TOE are interchangeable in this
                            document.</description>
                    </entry>
                    <entry>
                        <term>XSS</term>
                        <!-- <description>Cross Site Scripting - Vulnerability resulting from
                            insufficient filtering of special characters that allows an attacker to
                            inject a script into a web page, which is later displayed by a browser;
                            allows the attack to deface web sites or steal session
                            information.</description> -->
                        <description>Cross Site Scripting - Client-side injection of a script into a
                            dynamic web page to target other users with attacks that can range in
                            severity (e.g., spoofed content, session hijacking, execution of
                            malicious code on a user’s browser, etc.).</description>
                    </entry>
                </glossary>
            </subsection>
        </section>
        <section title="Compliant Targets of Evaluation" id="TOEdescription"> This document provides
            an extended set of Security Functional Requirements (SFRs) for a web browser, which is
            the Target of Evaluation (TOE). <br/> The Protection Profile for Application Software
            defines the baseline SFRs for application software which runs on mobile devices ("apps")
            as well as on desktop and server platforms. This Extended Package (EP) for web browsers
            is not complete in itself, but rather extends the Protection Profile for Application
            Software. <br/> Web browsers are client applications that retrieve and render content
            provided by web servers, primarily using the hypertext transfer protocol (HTTP) or HTTP
            Secure (HTTPS). Browsers have grown in complexity over the years, starting as tools used
            to display simple, unchanging web pages and becoming sophisticated execution
            environments for web content. The use of browsers to administer accounts, servers or
            embedded systems remotely requires them to handle sensitive information securely.
            Innovations such as tabs, extensions and HTML5 have not only increased browser
            functionality, but also introduced new security concerns. As users' principal method for
            accessing the Internet, and due to their complexity and the information that they
            process, browsers are a natural target for attackers. As a result, it is paramount that
            the security of web browsers be assured to reduce the risk to networks. </section>

        <section title="Use Cases" id="usecases"> Web browsers are used to perform many tasks, and
            these can be categorized into three primary use cases. <usecases>
                <usecase title="Surfing the Web">
                    <description> Browsers are used to retrieve and display and execute content from
                        the web, such as web pages, streaming media, images and specialized formats
                        (e.g., Java, Flash, PDF). They can also be used to write content to web
                        sites (web 2.0 – e.g., Facebook). Web surfing can be done over the Internet
                        or within an Intranet. </description>
                </usecase>
                <usecase title="Remote Administration Client">
                    <description> Browsers are used to provide remote administration interfaces for
                        systems such as servers, network devices and embedded systems, to include
                        supervisory control and data acquisition (SCADA) sytems, smart TVs and
                        thermostats. As opposed to surfing the web, where the browser may be
                        interacting with untrusted servers, the browser, acting as a Remote
                        Administration Client, is connecting to a server that the user trusts.
                    </description>
                </usecase>
                <usecase title="Content Creation">
                    <description> Browsers are used to create content via an increasing number of
                        Software as a Service (SaaS) offerings, including Microsoft Office 365,
                        Google Drive, and Adobe Creative Cloud, where user data and records are
                        stored online. </description>
                </usecase>
            </usecases>
        </section>
    </chapter>
    <chapter title="Conformance Claims" id="conf">
        <!--
        <description>This <abbr linkend="EP"/> is conformant to Part 2 (extended) of Common Criteria
                <cite linkend="bibCC"/> Version 3.1, Revision 4.</description>
        <h3>PP Claim</h3>
        <description>This <abbr linkend="EP"/> extends the Protection Profile for Application
            Software but does not claim conformance to any other Protection Profile.</description>
        <h3>Package Claim</h3>
        <description>This <abbr linkend="EP"/> does not claim conformance to any
            packages.</description>
            -->
        <cclaims>
            <cclaim id="Conformance Statement">
                <description> The Protection Profile for Application Software (App PP) defines the
                    baseline Security Functional Requirements (SFRs) and Security Assurance
                    Requirements (SARs) for application software products. This EP serves to extend
                    the App PP baseline with additional SFRs and associated Assurance Activities
                    specific to a web browser. Assurance Activities are the actions that the
                    evaluator performs in order to determine a TOE’s compliance to the SFRs.<br/>
                    This EP conforms to Common Criteria <cite linkend="bibCC"/> for Information
                    Technology Security Evaluation, Version 3.1, Revision 4. It is CC Part 2
                    extended and CC Part 3 conformant. In order to be conformant to this EP, the ST
                    must include all components in this EP and the associated App PP that are:
                            <ul><li>unconditional (which are always required)</li>
                        <li>selection-based (which are required when certain selections are chosen
                            in the unconditional requirements)</li>
                    </ul> and may include components that are: <ul><li>optional or</li>
                        <li>objective.</li></ul></description>
            </cclaim>
        </cclaims>
    </chapter>
    <chapter title="Security Problem Description" id="spd"> The security problem is described in
        terms of the threats that the web browser is expected to address, assumptions about the
        operational environment, and any organizational security policies that it is expected to
        enforce. <br/> This Extended Package does not repeat the threats, assumptions, and
        organizational security policies identified in the App PP, though they all apply given the
        conformance and hence dependence of this EP on it. Together the threats, assumptions and
        organizational security policies of the App PP and those defined in this EP describe those
        addressed by a web browser as the Target of Evaluation. <br/> Notably, browsers are
        particularly at risk from the Network Attack threat identified in the App PP. Attackers can
        use phishing or another social engineering technique to persuade a user to visit a malicious
        site. Users may also unintentionally visit malicious sites in the course of web browsing.
        Such sites then present malicious content to the user's browser to exploit it and perform
        installation of malware, often with no indication to the user. <section title="Threats"
            id="threattable">The following threats are specific to web browsers, and represent an
            addition to those identified in the App PP. <threats>
                <threat id="T.FLAWED_ADDON">
                    <description> Web browser functionality can be extended through the integration
                        of third-party utilities and tools. Malicious or vulnerable add-ons could
                        result attacks against the system. Such attacks allowing unauthorized access
                        to sensitive information in the browser, unauthorized access to the
                        platform's file system, or even privilege escalation that enables
                        unauthorized access to other applications or the operating system.
                    </description>
                </threat>
                <threat id="T.SAMEORIGIN_VIOLATION">
                    <description> Violating the same-origin policy is a specialized type of network
                        attack (covered generally as T.NETWORK_ATTACK in the App PP) which involves
                        web content violating access control policies enforced by a web browser to
                        separate the content of different web domains. It is specifically identified
                        as a threat to web browsers, since they implement the access control
                        policies that are violated in these attacks. <br/> Attacks which involve
                        same origin violations are: <ul>
                            <li>Insufficient protection of session tokens can lead to session
                                hijacking, where a token is captured and reused in order to gain the
                                privileges of the user who initiated the session.</li>
                            <li>Cross-site scripting (XSS) and cross-site request forgery (CSRF)
                                attacks are methods used to compromise user credentials (usually by
                                stealing the user's session token) to a web site. These attacks are
                                more likely a result of server security problems, but some browsers
                                incorporate technologies that try to detect the attacks.</li>
                            <li>Inadequate sandboxing of browser tabs/windows or a faulty cross
                                domain communications model can lead to leakage of content from one
                                domain in one tab/window to a different domain in a different
                                tab/window. Such attacks leverage the ability of browsers to display
                                content from multiple domains simultaneously.</li>
                        </ul>
                    </description>
                </threat>
            </threats>
        </section>
    </chapter>
    <chapter title="Security Objectives" id="sobj"> This Extended Package adds security objectives
        to those identified in the Protection Profile for Application Software (App PP). <section
            title="Security Objectives for the TOE" id="SecurityObjectivesTOE">
            <SOs>
                <SO id="O.DOMAIN_ISOLATION">
                    <description> To address the network attack associated with content leakage
                        between different web domains, the browser must ensure that content
                        originating from different domains (e.g., in a tab or iFrame) is properly
                        isolated. </description>
                    <component-refer ref="fdp_sop_ext.1"/>
                    <component-refer ref="fdp_acf_ext.1.1"/>
                </SO>
                <SO id="O.ADDON_INTEGRITY">
                    <description> To address issues associated with malicious or flawed add-ons,
                        conformant browsers implement mechanisms to ensure their integrity. This
                        includes verification at installation time and update. </description>
                    <component-refer ref="fia_x509_ext.1.1"/>
                    <component-refer ref="fpt_tud_ext.2"/>
                </SO>
            </SOs>
        </section>
    </chapter>

    <chapter title="Security Requirements" id="req">This chapter describes the security requirements
        which have to be fulfilled by the TOE. Those requirements comprise functional components
        from Part 2 of <cite linkend="bibCC"/>. The following notations are used: <ul>
            <li>
                <b>Selection</b> (denoted by <i>italicized text</i>): is used to select one or more
                options provided by the [CC] in stating a requirement.</li>
            <li>
                <b>Assignment</b> operation (denoted by <i>italicized text</i>): is used to assign a
                specific value to an unspecified parameter, such as the length of a password.
                Showing the value in square brackets indicates assignment.</li>
            <li>
                <b>Iteration</b> operation: are identified with a number inside parentheses (e.g.
                "(1)")</li>
        </ul>
        <section title="Security Functional Requirements" id="SFR">This section addresses those
            Security Functional Requirements that may be met by the TOE. <subsection
                title="Cryptographic Support (FCS)" id="fcs">
                <f-component id="FCS_STS_EXT.1" name="Strict Transport Security">
                    <f-element id="FCS_STS_EXT.1.1" status="objective">
                        <title>The browser shall implement HTTP Strict-Transport-Security according
                            to RFC 6797.</title>
                    </f-element>
                    <f-element id="FCS_STS_EXT.1.2" status="objective">
                        <title>The browser shall retain persistent data signaling HSTS enablement
                            for the time span declared by the website in a max-age
                            directive.</title>
                    </f-element>
                    <f-element id="FCS_STS_EXT.1.3" status="objective">
                        <title>The browser shall cache the freshest Strict Security policy
                            information.</title>
                        <note role="application"> If a browser receives the HSTS header from a
                            website, all future HTTP sessions between the browser and the domain or
                            superdomain of that website must occur over TLS 1.2 (RFC 5246) or
                            greater by utilizing HTTPS (RFC 2818). </note>
                        <aactivity>
                            <tss> The evaluator shall examine the TSS to ensure that it documents
                                how the TOE supports HSTS. </tss>
                            <guidance> The evaluator shall examine the operational guidance to
                                ensure it contains instructions on how to use HSTS. </guidance>
                            <tests> The evaluator shall perform the following tests: <testlist>
                                    <test>The evaluator shall connect to a HSTS-compliant website
                                        while running a network protocol analyzer to monitor the
                                        traffic. The evaluator shall examine the captured network
                                        traffic and verify that a Strict Transport Security header
                                        is received and that there is a directive for the max-age of
                                        the HSTS relationship.</test>
                                    <test>The evaluator shall reconnect to the HSTS website again
                                        over HTTP and shall verify that the session is redirected to
                                        HTTPS.</test>
                                    <test>The evaluator shall reconnect to the HSTS website after
                                        the max-age has expired, and verify that the website and TOE
                                        reestablish an HSTS relationship.</test>
                                    <test>The evaluator shall update the website HSTS information,
                                        and verify that when the TOE reconnects to the website, that
                                        information is updated by the TOE.</test>
                                </testlist>
                            </tests>
                        </aactivity>
                    </f-element>
                </f-component>
            </subsection>
            <subsection title="User Data Protection (FDP)" id="fdp">
                <!-- <f-component id="FDP_ACC_EXT.1" name="Access Control on Domains">
                    <f-element id="FDP_ACC_EXT.1.1" status="objective">
                        <title>The browser shall provide the capability to group domains and apply
                            access restrictions to specific sets of domains.</title>
                        <note role="application"> An example of this functionality is the concept of
                            zones in Internet Explorer. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure it describes
                            how the TSF supports the grouping of domains and applying access
                            restrictions to them. <h4>Guidance</h4> The evaluator shall examine the
                            operational guidance to ensure it documents the steps for configuring
                            the ability to group domains and apply access restrictions.
                                <h4>Tests</h4> The evaluator shall perform the following tests: <ul>
                                <li>The evaluator shall create a group of domains and apply a
                                    specific restriction to the group. The evaluator shall navigate
                                    to websites within the domains in the restricted group and shall
                                    verify that the restriction is functional. The evaluator shall
                                    navigate to websites within domains not in the restricted group
                                    and shall verify that the restriction does not apply.</li>
                            </ul>
                        </aactivity>
                    </f-element>
                </f-component> -->
                <f-component id="FDP_ACF_EXT.1" name="Local and Session Storage Separation">
                    <f-element id="FDP_ACF_EXT.1.1">
                        <title>The browser shall separate local (permanent) and session (ephemeral)
                            storage based on domain, protocol and port:<br/>
                            <ul>
                                <li>Session storage shall be accessible only from the originating
                                    tab or window;</li>
                                <li>Local storage shall only be accessible from windows and tabs
                                    running the same web application.</li>
                            </ul></title>
                        <note role="application"> The separation of local and session storage is
                            described in World Wide Web Consortium (W3C) Proposed Recommendation:
                            "Web Storage."<br/> In this context, a domain is a realm of
                            administrative autonomy, authority or control on the Internet (e.g.,
                            cnn.com, ietf.org). A sub-domain is denoted by a prefix before the
                            top-level domain name (e.g., news.cnn.com). A protocol is a system of
                            digital rules for data exchange within or between computers; in a web
                            environment, the typical protocols are HTTP and HTTPS. A port is an
                            application-specific construct that functions as a communications
                            endpoint in a computer’s host OS; in a web environment, port 80 is the
                            default port for HTTP communications, although other ports can be used.
                            In a web address, the port follows the domain or sub-domain name (e.g.,
                            http://www.cnn.com:80).</note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure it describes
                            how the TSF separates local and session storage. <h4>Guidance</h4> The
                            evaluator shall examine the operational guidance to verify that it
                            documents the location on the file system that will be used for local
                            storage and the location used for session storage. <h4>Tests</h4> The
                            evaluator shall perform the following tests:<br/>
                            <testlist>
                                <test>The evaluator shall obtain or create JavaScript-based scripts
                                    that store and retrieve information from local and session
                                    storage and shall set up a web server with two or more web pages
                                    using different protocols and/or ports. The evaluator shall
                                    incorporate the scripts into the web pages. The evaluator shall
                                    open two or more browser windows and navigate to the same web
                                    page. The evaluator shall verify that the script for accessing
                                    session storage that is running in one window cannot access
                                    session storage associated with a different window.</test>
                                <test>Using the same web server, the evaluator shall open two or
                                    more browser tabs and navigate to the same web page. The
                                    evaluator shall verify that the script for accessing session
                                    storage that is running in one tab cannot access session storage
                                    associated with a different tab.</test>
                                <test>Using the same web server, the evaluator shall open two or
                                    more browser windows and navigate to the same web page. The
                                    evaluator shall verify that the script for accessing local
                                    storage that is running in one window can access local storage
                                    associated with a different window.</test>
                                <test>Using the same web server, the evaluator shall open two or
                                    more browser tabs and navigate to the same web page. The
                                    evaluator shall verify that the script for accessing local
                                    storage that is running in one tab can access local storage
                                    associated with a different tab.</test>
                                <test>Using the same web server, the evaluator shall open windows
                                    and tabs and navigate to different web pages. The evaluator
                                    shall verify that a script running in the context of one
                                    domain/protocol/port in a window or tab cannot access
                                    information associated with a different domain/protocol/port in
                                    a different window or tab.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <f-component id="FDP_COO_EXT.1" name="Cookie Blocking">
                    <f-element id="FDP_COO_EXT.1.1">
                        <title>The browser shall provide the capability to block the storage of
                            third party cookies by websites.</title>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure it describes
                            how the TSF blocks third party cookies and when the blocking occurs
                            (e.g., automatically, when blocking is enabled). <h4>Guidance</h4> The
                            evaluator shall examine the operational guidance to verify that it
                            provides a description of the configuration option for blocking of third
                            party cookies. <h4>Tests</h4> The evaluator shall perform the following
                            tests: <testlist>
                                <test>The evaluator shall clear all cookies and then configure the
                                    TOE so that storage of third party cookies is allowed. The
                                    evaluator shall load a web page that stores a third party
                                    cookie. The evaluator shall navigate to the location where
                                    cookies are stored and shall verify that the cookie is
                                    present.</test>
                                <test>The evaluator shall clear all cookies and then configure the
                                    TOE so that storage of third party cookies is blocked (i.e. not
                                    allowed). The evaluator shall load a web page that attempts to
                                    store a third party cookie and shall verify that the cookie was
                                    not stored.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <!--
                <f-component id="FDP_PBR_EXT.1" name="Private Browsing Sessions">
                    <f-element id="FDP_PBR_EXT.1.1" status="optional">
                        <title>The browser shall provide the capability to support private browsing
                            sessions.</title>
                        <note role="application"> Private browsing is a mode that allows a user to
                            browse the web without storing data such as browsing history, images,
                            and cookies. Browsers that support this capability should include this
                            requirement. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure that it
                            describes how the TOE supports private browsing. The TSS shall specify
                            the data that is not stored locally when in private browsing mode and
                            describe the difference in interactions that the TOE has with websites
                            when operating and not operating in this mode. <h4>Guidance</h4> The
                            evaluator shall examine the operational guidance to ensure it includes
                            the steps for allowing or disallowing private browsing <h4>Tests</h4>The
                            evaluator shall perform the following test: <testlist>
                                <test>The evaluator shall clear the browsing history and cookie
                                    cache, and shall and enable private browsing. The evaluator
                                    shall navigate to test and/or actual websites and shall verify
                                    that the browsing history and cookie cache remain
                                    unchanged</test>
                                <test>The evaluator shall disable private browsing and shall revisit
                                    the same websites. The evaluator shall verify that the browsing
                                    history and the cookie cache have been updated and reflect the
                                    evaluator‘s browsing activities.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component> -->
                <f-component id="FDP_PST_EXT.1" name="Storage of Persistent Information">
                    <f-element id="FDP_PST_EXT.1.1" status="objective">
                        <title>The browser shall provide the capability to operate without storing
                            persistent data to the file system.</title>
                        <note role="application"> Exceptions from this requirement are credentials
                            and configuration information. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to verify it describes
                            how the TOE operates without storing persistent user data to the file
                            systems. <h4>Guidance</h4> N/A <h4>Tests</h4> The evaluator shall
                            perform the following test: <testlist>
                                <test>The evaluator shall operate the TOE for a period of time,
                                    ensuring that a wide variety of TOE functionality has been
                                    exercised. The evaluator shall then examine the TOE and the
                                    underlying platform to ensure that no files have been written to
                                    the file system other than credentials or configuration
                                    information.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <f-component id="FDP_SBX_EXT.1" name="Sandboxing of Rendering Processes">
                    <f-element id="FDP_SBX_EXT.1.1">
                        <title>The browser shall ensure that web page rendering is performed in a
                            process that is restricted in the following manner: <ul>
                                <li>The rendering process cannot directly access the platform's file
                                    system;</li>
                                <li>The rendering process cannot directly invoke inter-process
                                    communication mechanisms with non-browser processes;</li>
                                <li>The rendering process has reduced privilege with respect to
                                    other browser processes <selectables>
                                        <selectable>[assignment: methods by which the principle of
                                            least privilege is implement for rendering
                                            processes]</selectable>
                                        <selectable>in no other ways</selectable>
                                    </selectables></li>
                            </ul>
                        </title>
                        <note role="application"> Web browsers implement a variety of methods to
                            ensure that the process that renders HTML and interprets JavaScript
                            operates in a constrained environment in order to reduce the risk that
                            the rendering process can be corrupted by the HTML or JavaScript it is
                            processing. This component requires the TSF to lower the privileges of
                            rendering processes by ensuring that it cannot directly access the file
                            system of the host, and that it cannot use IPC mechanisms provided by
                            the host to communicate with non-browser processes on the host.
                            Typically, if a rendering process needs to access a file or communicate
                            with a non-browser process, it must request such access through the TSF
                            (which is allowed by the requirement).<br/> In addition to the two
                            required measures, other measures can be implemented depending on the
                            browser and the host platform. These may involve such actions as
                            changing the owner of the rendering process to a low-privileged account
                            or dropping platform-defined privileges in the rendering process. The ST
                            author fills in the additional measures implemented by the browser. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure it describes
                            how the rendering of HTML and interpretation of JavaScript is performed
                            by the TOE in terms of the platform processes that are involved (with
                            "process" being an active entity that executes code). For the processes
                            that render HTML or interpret JavaScript, the evaluator shall examine
                            the TSS to check that it describes how these processes are prevented
                            from accessing the platform file system. The evaluator shall check the
                            TSS to ensure it describes each platform-provided IPC mechanism, and
                            details for each mechanism how the rendering process is unable to use it
                            to communicate with non-TOE processes. The evaluator shall also confirm
                            that the TSS describes how IPC and file system access is enabled (if
                            this capability is implemented); for instance, through a more privileged
                            TOE process that does not perform web page rendering. The evaluator
                            shall ensure that these descriptions are present for all platforms
                            claimed in the ST.<br/> For each additional mechanism listed in the
                            third bullet of this component by the ST author, the evaluator shall
                            examine the TSS to ensure 1) the mechanisms is described; 2) the
                            description of the mechanism is sufficiently detailed to determine that
                            it contributes to the principle of least privilege being implemented in
                            the rendering process; and 3) appropriate supporting information is
                            provided in the TSS (or pointers to such information are provided) that
                            provides context for understanding the claimed least privilege
                            mechanisms. <h4>Guidance</h4> The evaluator shall examine the
                            operational guidance to determine that it provides a description of the
                            restrictions available on rendering processes. Additionally, if such
                            mechanisms are configurable (for instance, if a user can choose which
                            mechanisms to "turn on"), the evaluator shall examine the operational
                            guidance to ensure that the method for enabling and disabling the
                            mechanisms are provided, and the consequences of such actions are
                            described. <h4>Tests</h4>Note: The following tests require the developer
                            to provide access to a test platform that provides the evaluator with
                            debugging and test tools that are typically not found on consumer
                            platforms.<br/> The evaluator shall perform the following tests on each
                            platform claimed in the ST: <testlist>
                                <test>The evaluator shall use debugging or test facilities to
                                    introduce code into a rendering process that attempts to
                                    directly access the platform's file system, and then direct
                                    execution to it. The evaluator shall ensure that execution of
                                    this code fails to access the TOE file system.</test>
                                <test>For each IPC mechanism described in the TSS, the evaluator
                                    shall use debugging or test facilities to introduce code into a
                                    rendering process that attempts to directly communicate with
                                    another non-TOE process on the platform, and then direct
                                    execution to it. The evaluator shall ensure that this attempt
                                    fails.</test>
                                <test>For each additional mechanism claimed in the ST, the evaluator
                                    shall devise a test to show that the mechanism functions as
                                    described in the TSS. If no such test can be crafted, the
                                    evaluator shall provide a justification in the test report for
                                    why the mechanism cannot be tested.</test>
                                <test>For each mechanism that can be configured or turned on or off,
                                    the evaluator shall perform tests to ensure that the
                                    configuration of the mechanism behaves as specified in the
                                    operational guidance.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <f-component id="FDP_SOP_EXT.1" name="Same Origin Policy">
                    <f-element id="FDP_SOP_EXT.1.1">
                        <title>The browser shall ensure that content retrieved from one origin
                            cannot interact with content retrieved from another origin without
                            consent from the origin whose content is being retrieved.</title>
                    </f-element>
                    <f-element id="FDP_SOP_EXT.1.2">
                        <title>The browser shall not allow same origin policy exceptions for
                            different domains.</title>
                        <note role="application"> The Same Origin Policy concept is described in RFC
                            6454, "The Web Origin Concept."<br/> Origin is defined as the
                            combination of domain, protocol and port. Two URIs sharing the same
                            domain, protocol and port are considered to have the same origin. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure it describes
                            its implementation of a same origin policy and explains how it complies
                            with RFC 6454. If the TSF allows the relaxation of the same origin
                            policy for subdomains in different tabs or windows, the TSS shall
                            describe how these exceptions are implemented. <h4>Guidance</h4> N/A
                                <h4>Tests</h4>The evaluator shall perform the following tests: <testlist>
                                <test>The evaluator shall obtain or create scripts that can retrieve
                                    content from designated locations and shall set up a web server
                                    with two or more web pages representing different domains. The
                                    evaluator shall incorporate the scripts into the web pages. The
                                    evaluator shall associate each page with a different protocol
                                    and/or port. The evaluator shall open two or more browser
                                    windows and navigate to a different page on the website in each
                                    window. The evaluator shall run the scripts and shall verify
                                    that the script that is running in one window cannot access
                                    content that was retrieved in a different window.</test>
                                <test>Using the same web server, the evaluator shall open two or
                                    more browser tabs and navigate to a different page on the
                                    website in each tab. The evaluator shall run the scripts and
                                    shall verify that the script that is running in one tab cannot
                                    access content that was retrieved in a different tab.</test>
                                <test>If the TSF supports relaxation of the same origin policy for
                                    subdomains, the evaluator shall configure the web server with
                                    subdomains and shall repeat tests 1 and 2. The evaluator shall
                                    verify that the scripts can retrieve content from another
                                    window/tab at a different subdomain.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <f-component id="FDP_STR_EXT.1" name="Secure Transmission of Cookie Data">
                    <f-element id="FDP_STR_EXT.1.1">
                        <title>The browser shall ensure that cookies containing the <i>secure</i>
                            attribute in the set-cookie header are sent over HTTPS.</title>
                        <note role="application">The set-cookie header functionality is described in
                            RFC 6265 <i>HTTP State Management Mechanism</i>.</note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to verify it describes
                            the TOE‘s support for the ―secure‖ attribute of the set-cookie header in
                            accordance with RFC 6265, including the required sending of cookies
                            containing this attribute over HTTPS. <h4>Guidance</h4> N/A
                                <h4>Tests</h4>The evaluator shall perform the following tests: <testlist>
                                <test>The evaluator shall connect the TOE to a cookie-enabled test
                                    website implementing HTTPS and have the website present the TOE
                                    with a ―secure‖ cookie. The evaluator shall examine the TOE‘s
                                    cookie cache and verify that that it contains the secure
                                    cookie.</test>
                                <test>The evaluator shall reconnect to the cookie-enabled website
                                    over an insecure channel and verify that no ―secure‖ cookie is
                                    sent.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <f-component id="fdp_trk_ext.1" name="Tracking Information Collection">
                    <f-element id="fdp_trk_ext.1.1">
                        <title>The browser shall provide notification to the user when tracking
                            information for
                                    <selectables><selectable>geolocation</selectable><selectable>browser
                                    history</selectable><selectable>browser
                                    preferences</selectable><selectable>browser
                                    statistics</selectable></selectables> is requested by a
                            website.</title>
                        <note role="application">Selections must be captured in the ST.</note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure it describes
                            the TSF‘s support for tracking information and specifies the tracking
                            information that the TOE allows websites to collect about the TOE user.
                                <h4>Guidance</h4> The evaluator shall examine the operational
                            guidance to ensure it describes any notifications that the user will
                            receive when tracking information is requested by a website and the
                            options that the user has upon receiving the notification.
                                <h4>Tests</h4>The evaluator shall perform the following tests for
                            each type of tracking information listed in the TSS: <testlist>
                                <test>The evaluator shall configure a website that requests the
                                    tracking information about the user and shall navigate to that
                                    website. The evaluator shall verify that the user is notified
                                    about the request for tracking information and that, upon
                                    consent, the web site retrieves the tracking information.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
            </subsection>
            <subsection title="Identification and Authentication (FIA)" id="fia">
                <f-component id="FIA_X509_EXT.1" name="X509 Authentication">
                    <f-element id="FIA_X509_EXT.1.1">
                        <title>The browser shall not install code if the code signing certificate is
                            deemed invalid.</title>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure that it
                            describes how the TOE chooses which certificates to use.<br/> The
                            evaluator shall examine the TSS to ensure that it describes the behavior
                            of the TOE or TOE platform when a connection cannot be established
                            during the validity check of a certificate used in establishing a
                            trusted channel. <h4>Guidance</h4> The evaluator shall verify that any
                            necessary instructions are contained in the operational guidance for
                            configuring the operating environment so that the TOE can use the
                            certificates.<br/> If the requirement is that the administrator is able
                            to specify the default action, then the evaluator shall ensure that the
                            operational guidance contains instructions on how this configuration
                            action is performed. <h4>Tests</h4> The evaluator shall perform Test 1
                            for each function listed in FIA_X509_EXT.2.1 that requires the use of
                            certificates: <testlist>
                                <test>The evaluator shall demonstrate that using a certificate
                                    without a valid certification path results in the function
                                    failing or in the receipt of a user notification (as required by
                                    elements 3 and 4). The evaluator shall then load into the
                                    platform‘s root store any certificates needed to validate the
                                    certificate to be used in the function, and demonstrate that the
                                    function succeeds.</test>
                                <test>The evaluator shall demonstrate that using a valid certificate
                                    that requires certificate validation checking to be performed in
                                    at least some part by communicating with a non-TOE IT entity.
                                    The evaluator shall then manipulate the environment so that the
                                    TOE is unable to verify the validity of the certificate, and
                                    observe that the action selected in FIA_X509_EXT.2.2 is
                                    performed. If the selected action is administrator-configurable,
                                    then the evaluator shall follow the operational guidance to
                                    determine that all supported administrator-configurable options
                                    behave in their documented manner.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
            </subsection>
            <subsection title="Protection of the TSF (FPT)" id="fpt">
                <f-component id="FPT_DNL_EXT.1" name="Launch of Downloaded Executables">
                    <f-element id="FPT_DNL_EXT.1.1">
                        <title>The browser shall prevent downloaded executables from launching
                            automatically.</title>
                    </f-element>
                    <f-element id="FPT_DNL_EXT.1.2">
                        <title>The browser shall present the user with the option to either download
                            or discard the executable.</title>
                        <note role="application"> In this context, an executable is a file
                            containing compiled code for a software program that, when launched,
                            initiates the installation of the program. It is invoked independent of
                            and outside the context of the TOE. It does not include mobile code,
                            scripts, or plug-ins.<br/> This requirement does not include the
                            invocation of any program that is already installed on the TOE
                            platform.<br/> This requirement ensures that if the user intentionally
                            (via clicking on a link) or unintentionally initiates the download of an
                            executable, the TSF will intervene by, for example, opening a dialog box
                            that presents the user with the option to either save the executable to
                            the file system or not download the executable. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure that it
                            describes the behavior of the TSF when a user initiates the download of
                            an executable. <h4>Guidance</h4> The evaluator shall examine the
                            operational guidance to ensure it describes the dialog box that appears
                            when a download is initiated and the implications of the options
                            presented by the dialog box. <h4>Tests</h4>The evaluator shall perform
                            the following tests: <testlist>
                                <test>The evaluator shall navigate to a website that hosts
                                    executables and shall attempt to download and launch several
                                    executables. The evaluator shall verify that the TOE always
                                    presents a dialog box with the option to either download the
                                    executable to the file system or discard the executable.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <f-component id="FPT_ETUD_EXT.1" name="Allowance for Add-ons">
                    <f-element id="FPT_ETUD_EXT.1.1">
                        <title>The browser shall include the capability to load <selectables>
                                <selectable>none</selectable>
                                <selectable>browser add-ons</selectable>
                            </selectables>. </title>
                    </f-element>
                </f-component>
                <!--                <f-component id="FPT_INT_EXT.X" name="Interactions with Background Processes">
                    <f-element id="FPT_INT_EXT.X.1">
                        <title>The browser shall shut down any browser-spawned background processes
                            when the browser exits.</title>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure it describes
                            all browser-spawned processes that run while the TOE is running and
                            describes the ability to terminate these processes when the TOE exits.
                            The TSS should also describe the nature of the background processes, the
                            circumstances under which they are spawned, the process/image names
                            associated with them (if any) and their expected lifetimes.
                                <h4>Guidance</h4> N/A <h4>Tests</h4>The evaluator shall perform the
                            following tests: <testlist>
                                <test>The evaluator shall start an instance of the TOE. The
                                    evaluator shall inspect the TOE platform‘s running processes and
                                    identify which are associated with the TOE instance. The
                                    evaluator shall shut down the TOE instance and verify that the
                                    TOE background processes have been terminated.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component> -->
                <f-component id="FPT_INT_EXT.1"
                    name="Interactions with Application Reputation Services">
                    <f-element id="FPT_INT_EXT.1.1" status="objective">
                        <title>The browser shall utilize an application reputation service to
                            prevent downloading of malicious applications.</title>
                        <note role="application"> An application reputation service is an online
                            service that identifies malicious applications; it is used to detect
                            such applications prior to downloading them. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure it describes
                            the TOE‘s use of application reputation services in detecting malicious
                            applications. <h4>Guidance</h4> The evaluator shall examine the
                            operational guidance to ensure it describes the TOE‘s support for use of
                            an application reputation service, including which services the TOE
                            supports by default (if any) and whether additional services can be
                            configured. The operational guidance shall include steps for how to
                            configure the application reputation service. <h4>Tests</h4> The
                            evaluator shall perform the following tests: <testlist>
                                <test>The evaluator shall configure the TOE to enable the use of one
                                    or more application reputation services per the operational
                                    guidance. The evaluator shall initiate a connection with a
                                    website that attempts to download an application to the TOE
                                    while sniffing the network traffic using a network protocol
                                    analyzer. The evaluator shall inspect the captured network
                                    traffic and shall verify that the TOE initiates a connection to
                                    the configured application reputation service(s) before
                                    initiating the download.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <f-component id="FPT_INT_EXT.2" name="Interactions with URL Reputation Services">
                    <f-element id="FPT_INT_EXT.2.1" status="objective">
                        <title>The browser shall utilize a URL reputation service to prevent
                            connections with malicious websites.</title>
                        <note role="application"> A URL reputation service is an online service that
                            identifies websites with malicious or phishing content applications; it
                            is used to detect such websites prior to allowing users to access them.
                            The goal of this requirement is to ensure that the TOE is prevented from
                            establishing connections with known-bad sources of malware on the
                            Internet. The specifics of the sequence of actions taken before a block
                            decision is made may depend upon the specific implementation of the TOE.
                            For example, some TOEs might implement the check for malicious content
                            by checking against the list of bad URLs provided by the URL reputation
                            service in real time; others may download updated lists of bad URLs at
                            TOE startup, updating the list periodically from the URL reputation
                            service(s) until the TOE is terminated. Ultimately, the result should be
                            that the TOE blocks the connection to the bad URL. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure it describes
                            the TSF‘s use of a URL reputation service in detecting malicious
                            websites. <h4>Guidance</h4> The evaluator shall examine the operational
                            guidance to ensure it describes the TOE‘s support for use of URL
                            reputation services, including which services the TOE supports by
                            default (if any) and whether additional services can be configured. The
                            operational guidance shall include steps for how to configure the URL
                            reputation service. <h4>Tests</h4> The evaluator shall perform the
                            following tests: <testlist>
                                <test>The evaluator shall configure the TOE to enable the use of one
                                    or more URL reputation services per the operational guidance.
                                    The evaluator shall initiate a connection with a known good
                                    website while sniffing the network traffic using a network
                                    protocol analyzer. The evaluator shall inspect the captured
                                    network traffic and shall verify that the TOE initiates a
                                    connection to the configured URL reputation service(s).</test>
                                <test>The evaluator shall configure the TOE to enable the use of one
                                    or more URL reputation services per the operational guidance.
                                    The evaluator shall initiate a connection with a known malicious
                                    website that is identified by one or more of the URL reputation
                                    services while sniffing the network traffic using a network
                                    protocol analyzer. The evaluator shall verify that a warning
                                    appears alerting that the website is known to be malicious and
                                    the TOE is not allowed to connect. The evaluator shall inspect
                                    the captured network traffic and shall verify that the TOE
                                    initiates a connection to the configured URL reputation
                                    service(s) and retrieved an updated list of malicious URLs with
                                    the tested website being on the list.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <f-component id="FPT_MCD_EXT.1" name="Mobile Code">
                    <f-element id="FPT_MCD_EXT.1.1">
                        <title>The browser shall support the capability to execute signed
                                <selectables linebreak="yes">
                                <selectable>ActiveX</selectable>
                                <selectable>Flash</selectable>
                                <selectable>Java</selectable>
                                <selectable>[assignment: other mobile code types supported by the
                                    browser]</selectable>
                            </selectables>mobile code.</title>
                    </f-element>
                    <!-- moved to FPT_MOF 
                        <f-element id="FPT_MCD_EXT.1.3">
                        <title>The browser shall notify the user when unsigned, untrusted or
                            unverified <selectables>
                                <selectable>Active X</selectable>
                                <selectable>Flash</selectable>
                                <selectable>Java</selectable>
                                <selectable>[assignment: other mobile code types supported by the TOE]</selectable>
                            </selectables>mobile code is encountered.</title>
                    </f-element> -->
                    <f-element id="FPT_MCD_EXT.1.2">
                        <title>The browser shall provide the user with the option to discard
                            unsigned, untrusted or unverified <selectables linebreak="yes">
                                <selectable>Active X</selectable>
                                <selectable>Flash</selectable>
                                <selectable>Java</selectable>
                                <selectable>[assignment: other mobile code types supported by the
                                    browser]</selectable>
                            </selectables> mobile code without executing it.</title>
                        <note role="application"> The ST author must specify all mobile code types
                            for which the browser provides this support. <br/>An authorized signer
                            may directly sign the code itself, or the code may be delivered over an
                            authenticated HTTPS connection with an authorized entity. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to ensure it lists the
                            types of signed mobile code that the TSF supports. The TSS shall
                            describe how the TSF handles unsigned mobile code, mobile code from an
                            untrusted source, and mobile code from an unverified source.
                                <h4>Guidance</h4> The evaluator shall examine the operational
                            guidance to verify it provides configuration instructions for each of
                            the supported mobile code types. The operational guidance shall also
                            describe the alert that the TOE displays to the user when unsigned,
                            untrusted, or unverified mobile code is encountered and the actions the
                            user can take. <h4>Tests</h4>The evaluator shall perform the following
                            tests for each mobile code type specified in the TSS: <testlist>
                                <test>The evaluator shall construct web pages containing unsigned,
                                    correctly authenticated, and incorrectly authenticated mobile
                                    code and ensure that the TOE alerts the user when it encounters
                                    mobile code that fails to authenticate and provides the user
                                    with the option to discard the mobile code without executing it,
                                    but does execute mobile code that properly authenticates.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <!-- <f-component id="FPT_TUD_EXT.X" name="Trusted Extension Update">
                    <f-element id="FPT_TUD_EXT.X.1" status="sel-based">
                        <selection-depends req="FPT_ETUD_EXT.1.1"/>
                        <title>The browser shall provide the capability to query the current version
                            of the extension.</title>
                    </f-element>
                    <f-element id="FPT_TUD_EXT.X.2" status="sel-based">
                        <selection-depends req="FPT_ETUD_EXT.1.1"/>
                        <title>The browser shall provide the capability to initiate extension
                            updates.</title>
                    </f-element>
                    <f-element id="FPT_TUD_EXT.X.3" status="sel-based">
                        <selection-depends req="FPT_ETUD_EXT.1.1"/>
                        <title>The browser shall provide a means to verify extensions and extension
                            updates using a digital signature mechanism prior to installing the
                            extension or extension updates.</title>
                    </f-element>
                    <f-element id="FPT_TUD_EXT.X.4" status="sel-based">
                        <selection-depends req="FPT_ETUD_EXT.1.1"/>
                        <title>The browser shall prevent websites from automatically installing
                            extensions.</title>
                        <note role="application"> Extensions are bundles of code that are added to
                            the browser to add specific functionality that the browser does not
                            provide by default. Extensions could be developed by the browser vendor
                            or by third parties and are allowed full access to view and interact
                            with the web content that the browser sees. Extensions are common on
                            non-mobile platforms, but may not be supported on mobile platforms,
                            where HTML5 tends to be used for websites that serve rich content. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to verify that it
                            describes the ability of the TSF to verify that extensions and extension
                            updates come from a trusted source. The evaluator shall examine the TSS
                            to verify that it states that the TSF will reject extensions from
                            unapproved sources. <h4>Guidance</h4> The evaluator shall examine the
                            operational guidance to verify that it includes instructions on how to
                            configure the TOE with trusted extension sources. <h4>Tests</h4> The
                            evaluator shall perform the following tests: <testlist>
                                <test>The evaluator shall configure the TOE with trusted sources.
                                    The evaluator shall create or obtain an extension signed by a
                                    trusted source and attempt to install it. The evaluator shall
                                    verify that the signature on the extension is valid.</test>
                                <test>The evaluator shall create or obtain an extension signed by an
                                    untrusted source and attempt to install it. The evaluator shall
                                    verify that the signed extension is rejected.</test>
                                <test>The evaluator shall create or obtain an extension signed with
                                    an invalid certificate and attempt to install it. The evaluator
                                    shall verify that the signed extension is rejected.</test>
                                <test>The evaluator shall create or obtain an extension signed by a
                                    trusted source, modify the extension without re-signing it, and
                                    attempt to install it. The evaluator shall verify that the
                                    signed extension is rejected.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component> -->
                <f-component id="FPT_TUD_EXT.2" name="Trusted Installation and Updates for Add-ons">
                    <f-element id="FPT_TUD_EXT.2.1" status="sel-based">
                        <selection-depends req="FPT_ETUD_EXT.1.1"/>
                        <title>The browser shall provide the ability to query the current version of
                            the add-on.</title>
                    </f-element>
                    <f-element id="FPT_TUD_EXT.2.2" status="sel-based">
                        <selection-depends req="FPT_ETUD_EXT.1.1"/>
                        <title>The browser shall provide the ability to initiate the downloading of
                            add-ons and add-on updates.</title>
                    </f-element>
                    <f-element id="FPT_TUD_EXT.2.3" status="sel-based">
                        <selection-depends req="FPT_ETUD_EXT.1.1"/>
                        <title>The browser shall provide a means to verify add-ons using a digital
                            signature mechanism and <selectables>
                                <selectable>published hash</selectable>
                                <selectable>no other functions</selectable>
                            </selectables> prior to installing the add-on.</title>
                    </f-element>
                    <f-element id="FPT_TUD_EXT.2.4" status="sel-based">
                        <selection-depends req="FPT_ETUD_EXT.1.1"/>
                        <title>The browser shall prevent websites from automatically installing
                            add-ons.</title>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to verify that it
                            states that the TSF will reject add-ons from unapproved sources.
                                <h4>Guidance</h4> The evaluator shall examine the operational
                            guidance to verify that it includes instructions on how to configure the
                            TOE with trusted add-on sources. <h4>Tests</h4> The evaluator shall
                            perform the following tests: <testlist>
                                <test>The evaluator shall configure the TOE with trusted add-on
                                    sources. The evaluator shall create or obtain an add-on signed
                                    by a trusted source and attempt to install it. The evaluator
                                    shall verify that the signature on the add-on is valid.</test>
                                <test>The evaluator shall create or obtain an add-on signed by an
                                    untrusted source and attempt to install it. The evaluator shall
                                    verify that the signed add-on is rejected.</test>
                                <test>The evaluator shall create or obtain an add-on signed with an
                                    invalid certificate and attempt to install it. The evaluator
                                    shall verify that the signed add-on is valid.</test>
                                <test>The evaluator shall create or obtain an add-on signed by a
                                    trusted source, modify the add-on without re-signing it, and
                                    attempt to install it. The evaluator shall verify that the
                                    signed add-on is rejected.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
            </subsection>
            <subsection title="Security Management (FMT)" id="fmt">
                <f-component id="fmt_mof.1" name="Management of Functions Behavior">
                    <f-element id="fmt_mof.1.1">
                        <title>The browser shall restrict the ability to manage/perform functions as
                            follows:</title>
                        <ul>
                            <li>X = Mandatory</li>
                            <li>O = Optional</li></ul>
                        <table><tr class="header"><td>Management
                                    Function</td><td>Administrator</td><td>User</td></tr>
                            <tr><td>Enable/disable storage of third party
                                    cookies</td><td>O</td><td>X</td></tr>
                            <tr><td>Enable/disable add-ons</td><td>O</td><td>O</td></tr>
                            <tr><td>Enable/disable use of OCSP for obtaining the revocation status
                                    of an X.509 certificate</td><td>O</td><td>O</td></tr>
                            <tr><td>Configure inclusion of user-agent information in HTTP
                                    headers</td><td>O</td><td>X</td></tr>
                            <tr><td>Enable/disable ability for websites to collect tracking
                                    information about the user</td><td>O</td><td>X</td></tr>
                            <tr><td>Deletion of stored browsing data (cache, web form
                                    information)</td><td>O</td><td>X</td></tr>
                            <tr><td>Enable/disable storage of sensitive information in persistent
                                    storage</td><td>O</td><td>X</td></tr>
                            <tr><td>Configure size of cookie cache </td><td>O</td><td>O</td></tr>
                            <tr><td>Configure size of cache </td><td>O</td><td>O</td></tr>
                            <tr><td>Enable/disable interaction with Graphic Processing Units
                                    (GPUs)</td><td>X</td><td>O</td></tr>
                            <tr><td>Configure the ability to advance to a web site with an invalid
                                    or unvalidated X.509 certificate</td><td>O</td><td>O</td></tr>
                            <tr><td>Configure the use of an application reputation service to detect
                                    malicious applications prior to download
                                    </td><td>O</td><td>O</td></tr>
                            <tr><td>Configure the use of a URL reputation service to detect sites
                                    that contain malware or phishing
                                    content</td><td>O</td><td>O</td></tr>
                            <tr><td>Enable/disable automatic installation of software updates and
                                    patches</td><td>O</td><td>O</td></tr>
                            <tr><td>Enable/disable establishment of a trusted channel if the TSF
                                    cannot establish a connection to determine the validity of a
                                    certificate </td><td>O</td><td>O</td></tr>
                            <tr><td>Enable/disable ability for websites to register protocol
                                    handlers </td><td>O</td><td>O</td></tr>
                            <tr><td>Enable/disable display notification when unsigned, untrusted or
                                    unverified mobile code is
                                encountered.</td><td>O</td><td>O</td></tr>
                        </table>
                        <!-- <selectables>
                                <selectable>enable/disable storage of sensitive web form
                                    information</selectable>
                                <li>configuration of mobile code:</li>
                                <ol>
                                    <li>ability to install mobile code;</li>
                                    <li>ability to uninstall mobile code;</li>
                                    <li>ability to update mobile code;</li>
                                    <li>ability to execute unsigned mobile code;</li>
                                    <li>ability to execute mobile code from an untrusted or
                                        unverified publisher</li>
                                </ol>
                            </selectables>
                            <selectables linebreak="yes">
                                <selectable>enable/disable storage of third party
                                    cookies</selectable>
                                <selectable>enable/disable add-ons</selectable>
                                <ol>
                                    <selectable>ability to install add-ons</selectable>
                                    <selectable>ability to uninstall add-ons</selectable>
                                    <selectable>ability to update add-ons</selectable>
                                    <selectable>ability to disable add-ons</selectable>
                                </ol>
                                <selectable>enable/disable use of OCSP for obtaining the revocation
                                    status of an X.509 certificate</selectable>
                                <selectable>configure inclusion of user-agent information in HTTP
                                    headers</selectable>
                                <selectable>enable/disable ability for websites to collect tracking
                                    information about the user</selectable>
                                <selectable>deletion of stored browsing data (cache, web form
                                    information)</selectable>
                                <ol>
                                    <selectable>ability to specify which content should be
                                        deleted</selectable>
                                    <selectable>ability to delete all stored content</selectable>
                                    <selectable>automatically delete content upon termination of the
                                        browser session</selectable>
                                </ol>
                                <selectable>enable/disable storage of sensitive information in
                                    persistent storage</selectable>
                                <selectable>ability to specify location where downloaded files are
                                    saved to disk</selectable>
                                <selectable>configure size of cookie cache</selectable>
                                <selectable>enable/disable interaction with Graphic Processing Units
                                    (GPUs)</selectable>
                                <selectable>configure the ability to advance to a web site with an
                                    invalid or unvalidated X.509 certificate</selectable>
                                <selectable>enable/disable use of private browsing
                                    sessions</selectable>
                                <selectable>configure the use of an application reputation service
                                    to detect malicious applications prior to downloading
                                    them</selectable>
                                <selectable>configure the use of a URL reputation service to detect
                                    sites that contain malware or phishing content</selectable>
                                <selectable>enable/disable automatic installation of software
                                    updates and patches</selectable>
                                <selectable>enable/disable establishment of a trusted channel if the
                                    TSF cannot establish a connection to determine the validity of a
                                    certificate</selectable>
                                <selectable>enable/disable ability for websites to register protocol
                                    handlers.</selectable>
                            </selectables></title> -->
                        <note role="application"> The intent of this requirement is to allow the
                            user and administrator of the platform to configure the browser with
                            configuration policies. If the administrator has not set a policy for a
                            particular function, the user may still perform that function.
                            Enforcement of the policy is done by the browser itself, or the browser
                            and its platform in coordination with each other.</note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall verify that the TSS describes those
                            management functions which may only be configured by the TOE platform
                            administrator and cannot be over-ridden by the user when set according
                            to policy. <h4>Guidance</h4> The evaluator shall examine the operational
                            guidance to verify that it includes instructions for a TOE platform
                            administrator to configure the functions listed in FMT_MOF.1.1.
                                <h4>Tests</h4>The evaluator shall perform the following test:<br/>
                            <testlist>
                                <test>The evaluator shall create policies that collectively include
                                    all management functions controlled by the TOE platform
                                    administrator and cannot be over-ridden by the user as defined
                                    in FMT_MOF.1.1. The evaluator shall apply these policies to the
                                    TOE, attempt to override each setting as the user, and verify
                                    that the TSF does not permit it.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
                <!--
This seems like an OS requirement; the TOE should instead accept management from the roles
via FMT_SMF and FMT_MOF.

<f-component id="FMT_SMR.1" name="Security Management Roles">
                    <f-element id="FMT_SMR.1.1">
                        <title>The <selectables>
                                <selectable>TOE</selectable>
                                <selectable>TOE platform</selectable>
                            </selectables> shall maintain the roles: Administrator.</title>
                    </f-element>
                    <f-element id="FMT_SMR.1.2">
                        <title>The <selectables>
                                <selectable>TOE</selectable>
                                <selectable>TOE platform</selectable>
                            </selectables> shall be able to associate users with roles.</title>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS and user documents to
                            verify that they describe the administrator role and the powers granted
                            to and limitations of the role. <h4>Guidance</h4> The evaluator shall
                            examine the operational guidance to ensure that it contains instructions
                            for administering the TOE and which interfaces are supported.
                                <h4>Tests</h4> In the course of performing the testing activities
                            for the evaluation, the evaluator shall use all supported interfaces,
                            although it is not necessary to repeat each test involving an
                            administrative action with each interface. The evaluator shall ensure,
                            however, that each supported method of administering the TOE that
                            conforms to the requirements of this EP be tested; for instance, if the
                            TOE can be administered through a local hardware interface or TLS/HTTPS
                            then both methods of administration must be exercised during the
                            evaluation team‘s test activities. </aactivity>
                    </f-element>
                </f-component>
				-->
            </subsection>
            <!--
 This may be covered in the App PP via FTP_DIT_EXT.1

 <subsection title="Trusted Path/Channel (FTP)" id="trustedPath">
                <f-component id="FTP_ITC.1" name="Inter-TSF Trusted Channel">
                    <f-element id="FTP_ITC.1">
                        <title><b>Refinement:</b> 
						The
                            <selectables>
                                <selectable>TOE</selectable>
                                <selectable>TOE platform</selectable>
                            </selectables> shall use <selectables>
                                <selectable>HTTPS</selectable>
                                <selectable>TLS</selectable>
                                <selectable>DTLS</selectable>
                            </selectables> to provide a trusted communication channel between itself
                            and another trusted IT product that is logically distinct from other
                            communication channels and provides assured identification of its end
                            points and protection of the channel data from disclosure and detection
                            of modification of the channel data.</title>
                    </f-element>
                    <f-element id="FPT_ITC.1.2">
                        <title>The <selectables>
                                <selectable>TOE</selectable>
                                <selectable>TOE platform</selectable>
                            </selectables> shall permit the TSF to initiate communication via the
                            trusted channel.</title>
                    </f-element>
                    <f-element id="FPT_ITC.1.3">
                        <title>The <selectables>
                                <selectable>TOE</selectable>
                                <selectable>TOE platform</selectable>
                            </selectables> shall initiate communication via the trusted channel for
                            all traffic traversing that connection.</title>
                        <note role="application"> The intent of the above requirement is to use the
                            cryptographic protocols identified in the requirement to establish and
                            maintain a trusted channel between the TOE and a trusted server. </note>
                        <aactivity>
                            <h4>TSS</h4> The evaluator shall examine the TSS to determine that it
                            describes the details of the TOE connecting to a web server in terms of
                            the cryptographic protocols specified in the requirement, along with
                            TOE-specific options or procedures that might not be reflected in the
                            specification. The evaluator shall also confirm that all protocols
                            listed in the TSS are specified and included in the requirements in the
                            ST. <h4>Guidance</h4> The evaluator shall confirm that the operational
                            guidance contains instructions for establishing the connection to the
                            access point, and that it contains recovery instructions should a
                            connection be unintentionally broken. <h4>Tests</h4>The evaluator shall
                            perform the following tests: <testlist>
                                <test>The evaluator shall ensure that the TOE or TOE platform is
                                    able to initiate communications with a web server using the
                                    protocols specified in the requirement, setting up the
                                    connections as described in the operational guidance and
                                    ensuring that communication is successful.</test>
                                <test>The evaluator shall ensure, for each communication channel
                                    with a web server, the channel data is not sent in
                                    plaintext.</test>
                            </testlist>
                        </aactivity>
                    </f-element>
                </f-component>
            </subsection>
			-->
        </section>
    </chapter>

    <appendix title="Optional Requirements" id="optional"> The baseline requirements (those that
        must be performed by the <abbr linkend="TOE"/>) are contained in the main body of this EP.
        Additionally, there are three other types of requirements specified in <appref
            linkend="optional"/>, <appref linkend="sel-based"/>, and <appref linkend="objective"/>.
        The first type (in this Appendix) are requirements that can be included in the <abbr
            linkend="ST"/>, but are not required in order for a TOE to claim conformance to this PP.
        The second type (in <appref linkend="sel-based"/>) are requirements based on selections in
        the body of the EP: if certain selections are made, then additional requirements in that
        appendix must be included. The third type (in <appref linkend="objective"/> are components
        that are not required in order to conform to this EP, but will be included in the baseline
        requirements in future versions of this EP, so adoption by vendors is encouraged. Note that
        the ST author is responsible for ensuring that requirements that may be associated with
        those in <appref linkend="optional"/>, <appref linkend="sel-based"/>, and <appref
            linkend="objective"/> but are not listed (e.g., FMT-type requirements) are also included
        in the ST. </appendix>

    <appendix title="Selection-Based Requirements" id="sel-based">As indicated in the introduction
        to this EP, the baseline requirements (those that must be performed by the browser or its
        underlying platform) are contained in the App PP and in the body of this EP. There are
        additional requirements based on selections from the App PP and/or in the body of the EP: if
        certain selections are made, then additional requirements below will need to be included. </appendix>

    <appendix title="Objective Requirements" id="objective"> This Annex includes requirements that
        specify security functionality which also addresses threats. The requirements are not
        currently mandated in the body of this EP as they describe security functionality not yet
        widely-available in commercial technology. However, these requirements may be included in
        the ST such that the TOE is still conformant to this EP, and it is expected that they be
        included as soon as possible. </appendix>

    <appendix id="biblio" title="References">
        <bibliography>
            <entry id="bibCC">
                <tag>CC</tag>
                <description>Common Criteria for Information Technology Security Evaluation - <ul>
                        <li><a
                                href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART1V3.1R4.pdf"
                                >Part 1: Introduction and General Model</a>, CCMB-2012-09-001,
                            Version 3.1 Revision 4, September 2012.</li>
                        <li><a
                                href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART2V3.1R4.pdf"
                                >Part 2: Security Functional Components</a>, CCMB-2012-09-002,
                            Version 3.1 Revision 4, September 2012.</li>
                        <li><a
                                href="http://www.commoncriteriaportal.org/files/ccfiles/CCPART3V3.1R4.pdf"
                                >Part 3: Security Assurance Components</a>, CCMB-2012-09-003,
                            Version 3.1 Revision 4, September 2012.</li>
                    </ul></description>
            </entry>
            <entry id="bibAppPP">
                <tag>AppPP</tag>
                <description>
                    <a href="https://www.niap-ccevs.org/pp/PP_APP_v1.1/">Protection Profile for
                        Application Software</a>
                </description>
            </entry>
        </bibliography>
    </appendix>

    <appendix title="Acronyms" id="acronyms">
        <acronyms>
            <entry>
                <term>AES</term>
                <description>Advanced Encryption Standard</description>
            </entry>
            <entry>
                <term>CBC</term>
                <description>Cipher Block Chaining</description>
            </entry>
            <entry>
                <term>CRL</term>
                <description>Certificate Revocation List</description>
            </entry>
            <entry>
                <term>CSP</term>
                <description>Cryptographic Service Provider</description>
            </entry>
            <entry>
                <term>CSRF</term>
                <description>Cross Site Request Forgery</description>
            </entry>
            <entry>
                <term>DHE</term>
                <description>Diffie-Hellman Key Exchange</description>
            </entry>
            <entry>
                <term>DN</term>
                <description>Distinguished Name</description>
            </entry>
            <entry>
                <term>DSA</term>
                <description>Digital Signature Algorithm</description>
            </entry>
            <entry>
                <term>DTLS</term>
                <description>Datagram Transport Layer Security</description>
            </entry>
            <entry>
                <term>ECC</term>
                <description>Elliptic Curve Cryptography</description>
            </entry>
            <entry>
                <term>ECDSA</term>
                <description>Elliptic Curve Digital Signature Algorithm</description>
            </entry>
            <entry>
                <term>EP</term>
                <description>Extended Package</description>
            </entry>
            <entry>
                <term>FFC</term>
                <description>Finite-Field Cryptography</description>
            </entry>
            <entry>
                <term>FIPS</term>
                <description>Federal Information Processing Standards</description>
            </entry>
            <entry>
                <term>GCM</term>
                <description>Galois/Counter Mode</description>
            </entry>
            <entry>
                <term>GPU</term>
                <description>Graphics Processing Unit</description>
            </entry>
            <entry>
                <term>HMAC</term>
                <description>Keyed Hash Message Authentication Code</description>
            </entry>
            <entry>
                <term>HTML</term>
                <description>HyperText Markup Language</description>
            </entry>
            <entry>
                <term>HTML5</term>
                <description>HyperText Markup Language version 5</description>
            </entry>
            <entry>
                <term>HTTP</term>
                <description>HyperText Transfer Protocol</description>
            </entry>
            <entry>
                <term>HTTPS</term>
                <description>HyperText Transfer Protocol Secure</description>
            </entry>
            <entry>
                <term>IETF</term>
                <description>Internet Engineering Task Force</description>
            </entry>
            <entry>
                <term>IV</term>
                <description>Initialization Vector</description>
            </entry>
            <entry>
                <term>KAT</term>
                <description>Known Answer Test</description>
            </entry>
            <entry>
                <term>KDF</term>
                <description>Key Derivation Function</description>
            </entry>
            <entry>
                <term>NIST</term>
                <description>National Institute of Standards and Technology</description>
            </entry>
            <entry>
                <term>OCSP</term>
                <description>Online Certificate Status Protocol</description>
            </entry>
            <entry>
                <term>OID</term>
                <description>Object Identifier</description>
            </entry>
            <entry>
                <term>PDF</term>
                <description>Portable Document Format</description>
            </entry>
            <entry>
                <term>rDSA</term>
                <description>RSA Digital Signature Algorithm</description>
            </entry>
            <entry>
                <term>RFC</term>
                <description>Request for Comment (IETF)</description>
            </entry>
            <entry>
                <term>RGB</term>
                <description>Random Bit Generator</description>
            </entry>
            <entry>
                <term>RSA</term>
                <description>Rivest Shamir Adelman</description>
            </entry>
            <entry>
                <term>SaaS</term>
                <description>Software as a Service</description>
            </entry>
            <entry>
                <term>SHA</term>
                <description>Secure Hash Algorithm</description>
            </entry>
            <entry>
                <term>SSL</term>
                <description>Secure Sockets Layer</description>
            </entry>
            <entry>
                <term>TLS</term>
                <description>Transport Layer Security</description>
            </entry>
            <entry>
                <term>W3C</term>
                <description>World Wide Web Consortium</description>
            </entry>
            <entry>
                <term>XSS</term>
                <description>Cross Site Scripting</description>
            </entry>
        </acronyms>
    </appendix>
</PP>
